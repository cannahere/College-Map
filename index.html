<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="google-site-verification" content="XLI_3QT03lSkcCEmteQWtQeDviYsA07lmIbGu_5GKCc" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Branding and Icons -->
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
  <link rel="manifest" href="site.webmanifest">

  <!-- SEO Meta Tags -->
  <title>U.S. College Map | Explore Colleges by Location, Type, and State</title>
  <link rel="canonical" href="https://uscollegemap.org/">
  <meta name="description" content="Use the U.S. College Map to explore accredited universities and colleges across America by location, type, and state. Filter, search, and find the best match for you.">
  <meta name="keywords" content="US college map, college finder, university map, colleges by location, college search USA, higher education map, universities by state">
  <meta name="author" content="U.S. College Map">

  <!-- Open Graph (Social Media Preview) -->
  <meta property="og:title" content="U.S. College Map | Explore Colleges by Location, Type, and State">
  <meta property="og:description" content="Find and explore U.S. colleges on an interactive map — filter by state, type, and proximity to your home.">
  <meta property="og:image" content="https://uscollegemap.org/USCollegeMap_Logo.png">
  <meta property="og:url" content="https://uscollegemap.org/">
  <meta property="og:type" content="website">

  <!-- Twitter Cards -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="U.S. College Map">
  <meta name="twitter:description" content="Explore accredited U.S. colleges and universities on an interactive map.">
  <meta name="twitter:image" content="https://uscollegemap.org/USCollegeMap_Logo.png">

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>
  <script src="https://unpkg.com/papaparse@5.4.1/papaparse.min.js"></script>

  <style>
    body {margin:0;font-family:Inter,system-ui,sans-serif;background:#fff;color:#0f172a}
    .container {max-width:1100px;margin:0 auto;padding:16px}
    header.app-header {position:sticky;top:0;background:#fff;z-index:10;border-bottom:1px solid #e2e8f0;box-shadow:0 10px 25px rgba(15,23,42,.08)}
    .app-header {display:flex;align-items:center;justify-content:flex-start;gap:16px;padding:16px 40px;background:#fff;border-bottom:1px solid #e5e7eb;box-shadow:0 4px 10px rgba(0,0,0,0.05)}
    .site-logo {height:70px;transition:all 0.3s ease;}
    @media (max-width:700px){
      .app-header{flex-direction:column;align-items:center;text-align:center}
      .site-logo{height:56px;margin-bottom:6px;}
    }
    .controls {display:flex;flex-direction:column;gap:12px;padding:14px 16px 16px;border-top:1px solid #e5e7eb;background:#fff}
    .row {display:flex;gap:12px;justify-content:space-between}
    .row>.pill {flex:1}
    .pill {display:flex;align-items:center;gap:8px;background:#f1f5f9;border:1px solid #e2e8f0;padding:6px 10px;border-radius:12px;font-size:12px}
    .pill label {color:#475569;font-weight:600;font-size:12px;min-width:60px}
    .pill input,.pill select,.pill button {border:1px solid #e2e8f0;border-radius:10px;padding:8px 10px;background:#fff;color:#0f172a;font-size:14px;flex:1}
    .pill button {background:#2563eb;color:#fff;border:none;font-weight:600;cursor:pointer;flex:0}
    #map {height:calc(100vh - 210px);background:#e5e7eb;border-top:1px solid #e2e8f0}
    .legend {position:absolute;bottom:14px;left:14px;background:#fff;padding:8px 10px;border-radius:12px;border:1px solid #e2e8f0;font-size:12px;box-shadow:0 10px 25px rgba(15,23,42,.08);color:#0f172a}
    .leaflet-tooltip {background:#fff;color:#0f172a;border:1px solid #e2e8f0;border-radius:6px;font-size:12px;font-weight:500;padding:4px 8px;box-shadow:0 2px 6px rgba(0,0,0,.1)}
    /* Suggestions hover */
    #suggestions div:hover { background:#f1f5f9; }
  </style>
</head>

<body>
<header class="app-header">
  <img src="USCollegeMap_Logo.png" alt="U.S. College Map logo" class="site-logo">
</header>

<div class="container controls">
  <div class="row">
    <div class="pill"><label for="type">Type</label><select id="type"><option value="">Any</option></select></div>
    <div class="pill"><label for="region">Region</label><select id="region"><option value="">All</option></select></div>
    <div class="pill"><label for="state">State</label><select id="state"><option value="">All</option></select></div>
    <div class="pill"><label for="search">Search</label><input id="search" placeholder="Search by college name..." /></div>
  </div>

  <div class="row">
    <div class="pill" style="position:relative;">
      <label for="address">Address</label>
      <input id="address" placeholder="Enter your home address" autocomplete="off" />
      <div id="suggestions" style="position:absolute;top:42px;left:70px;right:10px;background:#fff;
           border:1px solid #e2e8f0;border-radius:8px;box-shadow:0 4px 10px rgba(0,0,0,0.1);
           z-index:9999;font-size:13px;max-height:180px;overflow-y:auto;display:none;"></div>
      <button id="geocodeBtn">Set</button>
    </div>
    <div class="pill">
      <label for="radius">Radius</label>
      <input id="radius" type="number" min="0" step="10" value="50" style="width:90px">
      <select id="units"><option value="mi" selected>mi</option><option value="km">km</option></select>
      <button id="clearRadius" style="background:transparent;color:#0f172a;border:1px solid #e2e8f0;">Clear</button>
    </div>
  </div>
</div>

<div id="map"></div>
<div class="legend" id="legend">Showing <span id="count">0</span> schools</div>

<script>
const localMode = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
const DATA_URL = localMode ? 'colleges_usa_2024.csv' : 'https://uscollegemap.org/colleges_usa_2024.csv';

const americasBounds = L.latLngBounds([[-60,-180],[85,-30]]);
const map = L.map('map',{maxBounds:americasBounds,maxBoundsViscosity:1}).setView([39.5,-98.35],4);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{maxZoom:19,attribution:'&copy; OpenStreetMap contributors'}).addTo(map);

const markersLayer = L.layerGroup().addTo(map);
const homeLayer = L.layerGroup().addTo(map);
let colleges = [];

const TYPE_ORDER = ["Ivy League","Elite Private Universities","Public Flagship Universities","Private Liberal Arts Colleges","STEM / Technology Institutes","Business / Arts / Specialty Schools","Health & Medical Colleges","Faith-Based","Public Regional Universities","Community Colleges","Online / For-Profit"];

function render(){
  markersLayer.clearLayers();
  const stateVal=document.getElementById('state').value;
  const regionVal=document.getElementById('region').value;
  const typeVal=document.getElementById('type').value;
  const searchVal=document.getElementById('search').value.toLowerCase();

  let filtered=colleges.filter(c=>{
    const regionMatch=!regionVal||(
      (regionVal==='Northeast'&&['ME','NH','VT','MA','RI','CT','NY','NJ','PA'].includes(c.state))||
      (regionVal==='Midwest'&&['OH','MI','IN','IL','WI','MN','IA','MO','ND','SD','NE','KS'].includes(c.state))||
      (regionVal==='South'&&['DE','MD','DC','VA','WV','NC','SC','GA','FL','KY','TN','AL','MS','AR','LA','TX','OK'].includes(c.state))||
      (regionVal==='West'&&['MT','ID','WY','CO','NM','AZ','UT','NV','CA','OR','WA','HI','AK'].includes(c.state))||
      (regionVal==='Territories'&&['PR','GU','VI','AS','MP'].includes(c.state))
    );
    return regionMatch &&
      (!stateVal||c.state===stateVal)&&
      (!typeVal||(c.type||c.tier)===typeVal)&&
      (!searchVal||c.name.toLowerCase().includes(searchVal));
  });

  filtered.forEach(c=>{
    const tuition = c.tuition ? (c.tuition.toString().includes('$') ? c.tuition : `$${Number(c.tuition).toLocaleString()}`) : 'N/A';
    const acceptance = c.acceptance ? (c.acceptance.toString().includes('%') ? c.acceptance : `${parseFloat(c.acceptance).toFixed(1)}%`) : 'N/A';
    const popupContent = `
      <div style="font-size:12px;line-height:1.4">
        <b>${c.name}</b><br>
        ${c.state} · ${(c.type||'Unknown')}<br>
        ${c.control ? c.control + ' | ' : ''}Acceptance Rate: ${acceptance}<br>
        Enrollment: ${c.enrollment || 'N/A'}<br>
        Tuition: ${tuition}<br>
        ${c.url ? `<a href="https://${c.url.replace(/^https?:\/\//,'')}" target="_blank">${c.url}</a>` : ''}
      </div>`;
    L.circleMarker([c.lat,c.lon],{radius:5,color:'#2563eb',weight:2,fillOpacity:0.7})
      .bindTooltip(c.name,{permanent:false,direction:'top'})
      .bindPopup(popupContent)
      .addTo(markersLayer);
  });
  document.getElementById('count').textContent=filtered.length.toLocaleString();
}

function refreshDropdown(id,values,placeholder){
  const select=document.getElementById(id);
  select.innerHTML=`<option value="">${placeholder}</option>`+values.map(v=>`<option>${v}</option>`).join('');
}

function loadCSV(url){
  Papa.parse(url,{header:true,dynamicTyping:true,download:true,complete:(results)=>{
    colleges=results.data.filter(r=>r.name&&r.lat&&r.lon).map(r=>({
      name:r.name,lat:+r.lat,lon:+r.lon,state:(r.state||'').toUpperCase(),type:r.type||'Unknown',
      control:r.control||'',acceptance:r.acceptance||'',enrollment:r.enrollment||'',tuition:r.tuition||'',url:r.url||''
    }));
    const states=[...new Set(colleges.map(c=>c.state))].sort();
    const types=[...new Set(colleges.map(c=>c.type))].filter(Boolean);
    const ranked=[...TYPE_ORDER.filter(t=>types.includes(t))];
    const leftovers=types.filter(t=>!TYPE_ORDER.includes(t)).sort();
    const orderedTypes=ranked.concat(leftovers);
    refreshDropdown('state',states,'All');
    refreshDropdown('type',orderedTypes,'Any');
    refreshDropdown('region',['Northeast','Midwest','South','West','Territories'],'All');
    render();
  }});
}

function geocodeAddress(address){
  if(!address)return;
  fetch(`https://nominatim.openstreetmap.org/search?format=json&addressdetails=1&countrycodes=us&q=${encodeURIComponent(address)}&limit=1`)
    .then(r=>r.json()).then(data=>{
      if(data&&data[0]){
        const lat=+data[0].lat,lon=+data[0].lon;
        homeLayer.clearLayers();
        L.marker([lat,lon]).bindPopup("Home location").addTo(homeLayer).openPopup();
        map.setView([lat,lon],8);
      }
    });
}

document.getElementById('geocodeBtn').onclick=()=>geocodeAddress(document.getElementById('address').value);
document.getElementById('clearRadius').onclick=()=>{document.getElementById('radius').value='50';map.setView([39.5,-98.35],4);};
['state','region','type'].forEach(id=>document.getElementById(id).onchange=render);
document.getElementById('search').oninput=render;

/* === Clean U.S.-only address autocomplete === */
(() => {
  let debounceTimer;
  const addrInput = document.getElementById('address');
  const suggestionsBox = document.getElementById('suggestions');
  if (!addrInput || !suggestionsBox) return;

  const usQuery = q => `${q}, United States`;

  addrInput.addEventListener('input', () => {
    clearTimeout(debounceTimer);
    const q = addrInput.value.trim();
    if (q.length < 3) {
      suggestionsBox.style.display = 'none';
      suggestionsBox.innerHTML = '';
      return;
    }

    debounceTimer = setTimeout(() => {
      fetch(`https://nominatim.openstreetmap.org/search?format=json&addressdetails=1&limit=5&q=${encodeURIComponent(usQuery(q))}`)
        .then(r => r.ok ? r.json() : Promise.reject())
        .then(data => {
          if (Array.isArray(data) && data.length) {
            suggestionsBox.innerHTML = data.map(d => `
              <div data-lat="${d.lat}" data-lon="${d.lon}"
                   style="padding:6px 10px;cursor:pointer;border-bottom:1px solid #eee;">
                ${d.display_name.replace(', United States', '')}
              </div>
            `).join('');
            suggestionsBox.style.display = 'block';
          } else {
            suggestionsBox.style.display = 'none';
            suggestionsBox.innerHTML = '';
          }
        })
        .catch(() => { suggestionsBox.style.display = 'none'; suggestionsBox.innerHTML = ''; });
    }, 350);
  });

  suggestionsBox.addEventListener('click', (e) => {
    const t = e.target;
    if (t && t.dataset && t.dataset.lat) {
      addrInput.value = t.textContent;
      suggestionsBox.style.display = 'none';
      suggestionsBox.innerHTML = '';
      geocodeAddress(t.textContent);
    }
  });
})();

loadCSV(DATA_URL);
</script>

<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-E2KP0JHTMC"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-E2KP0JHTMC');
</script>
</body>
</html>
